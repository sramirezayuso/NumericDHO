#!/usr/bin/env ruby

m = 70.0
k = 10000.0
c = 100.0
tf = 0.00022
dt = 0.00002

r = 1.0
r1 = - (c/m/2.0)
r2 = (- (k * r) - (c * r1)) / m
r3 = 0.0
r4 = 0.0
r5 = 0.0

(0.00002..tf).step(dt) do |x| 

    puts "#{r}"
	
	rp = r + (r1 * dt) + ((r2 * dt**2) / 2.0) + ((r3 * dt**3) / 6.0) + ((r4 * dt**4) / 24.0) + ((r5 * dt**5) / 120.0)
	rp1 = r1 + (r2 * dt) + ((r3 * dt**2) / 2.0) + ((r4 * dt**3) / 6.0) + ((r5 * dt**4) / 24.0)
	rp2 = r2 + (r3 * dt) + ((r4 * dt**2) / 2.0) + ((r5 * dt**3) / 6.0)
	rp3 = r3 + (r4 * dt) + ((r5 * dt**2) / 2.0)
	rp4 = r4 + (r5 * dt)
	rp5 = r5

	ap = (- (k * rp) - (c * rp1)) / m
	dr = ((ap - rp2) * (dt**2)) / 2

	r = rp + (3.0/20.0) * dr
	r1 = rp1 + (251.0/360.0) * dr * (1.0/dt)
	r2 = rp2 +  dr * (2.0/dt**2)
	r3 = rp3 + (11.0/18.0) * dr * (6.0/dt**3)
	r4 = rp4 + (1.0/6.0) * dr * (24.0/dt**4)
	r5 = rp5 + (1.0/60.0) * dr * (120.0/dt**5)

end